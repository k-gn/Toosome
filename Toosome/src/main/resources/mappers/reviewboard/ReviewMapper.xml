<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.web.toosome.user.reviewboard.dao.IReviewBoardMapper">

	<resultMap type="reviewBoardVO" id="reviewBoardVO">
		<id property="reviewBoardId" column="REVIEW_BOARD_ID" />
		<result property="memberMemberId" column="MEMBER_MEMBER_ID" />
		<result property="productProductId" column="PRODUCT_PRODUCT_ID" />
		<result property="reviewBoardWriter" column="REVIEW_BOARD_WRITER" />
		<result property="reviewBoardContent" column="REVIEW_BOARD_CONTENT" />
		<result property="reviewBoardRegDate" column="REVIEW_BOARD_REG_DATE" />
		<result property="reviewBoardURegDate" column="REVIEW_BOARD_U_REG_DATE" />

	</resultMap>

	<select id="reviewBoardCount" resultType="int">
    SELECT COUNT(*) FROM REVIEW_BOARD
	</select>

	<select id="getreviewBoardList" parameterType="int" resultType="reviewBoardVO">
		SELECT REVIEW_BOARD_ID, PRODUCT_PRODUCT_ID, REVIEW_BOARD_CONTENT, REVIEW_BOARD_WRITER, REVIEW_BOARD_REG_DATE, REVIEW_BOARD_U_REG_DATE
        FROM REVIEW_BOARD A, PRODUCT B
        WHERE  A.PRODUCT_PRODUCT_ID = B.PRODUCT_ID AND A.PRODUCT_PRODUCT_ID=#{productId}
        ORDER BY REVIEW_BOARD_ID;
	</select>


	<insert id="reviewBoardInsert" parameterType="reviewBoardVO">
		<selectKey keyProperty="REVIEW_BOARD_ID" order="BEFORE" resultType="int">
			SELECT NVL(MAX(REVIEW_BOARD_ID), 0)+1 FROM REVIEW_BOARD
		</selectKey>
		INSERT INTO REVIEW_BOARD (
		REVIEW_BOARD_ID,
		MEMBER_MEMBER_ID,
		PRODUCT_PRODUCT_ID,
		REVIEW_BOARD_WRITER,
		REVIEW_BOARD_CONTENT,
		REVIEW_BOARD_REG_DATE,
		REVIEW_BOARD_U_REG_DATE
		) VALUES (
		#{reviewBoardId},#{memberMemberId},#{productProductId},#{reviewBoardWriter},#{reviewBoardContent},#{reviewBoardRegDate},#{reviewBoardURegDate})
	</insert>

	<update id="reviewBoardUpdate" parameterType="reviewBoardVO">
		UPDATE REVIEW_BOARD
		SET
		REVIEW_BOARD_CONTENT = #{reviewBoardContent}
		WHERE
		REVIEW_BOARD_ID = #{reviewBoardId}

	</update>

	<delete id="reviewBoardDelete" parameterType="int">
		DELETE FROM REVIEW_BOARD WHERE REVIEW_BOARD_ID = #{reviewBoardId}
	</delete>

</mapper>