<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.web.toosome.admin.boardManagement.dao.IQnaAdminMapper">

	<!-- QNA board -->
	<resultMap type="qnaBoardVO" id="QnaBoardMap">
		<id property="qnaBoardId" column="QNA_BOARD_ID"/>
		<result property="memberMemberId" column="MEMBER_MEMBER_ID" />
		<result property="qnaBoardType" column="QNA_BOARD_TYPE" />
	 	<result property="qnaBoardTitle" column="QNA_BOARD_TITLE" /> 
		<result property="qnaBoardContent" column="QNA_BOARD_CONTENT" />
		<result property="qnaBoardRegdate" column="QNA_BOARD_REG_DATE" />
		<result property="qnaBoardViewCount" column="QNA_BOARD_VIEW_COUNT" />	
		<result property="qnaBoardPassword" column="QNA_BOARD_PASSWORD" />		
		<result property="qnaBoardImageName" column="QNA_BOARD_IMAGE_NAME" />
		<result property="qnaBoardSecret" column="QNA_BOARD_SECRET" />
		<collection property="qnaBoardComment" resultMap="QnaBoardCommentMap" />
	</resultMap>
	
	<!-- QNA board Comment -->
	<resultMap type="qnaBoardCommentVO" id="QnaBoardCommentMap">
		<id property="qnaBoardCommentId" column="QNA_BOARD_COMMENT_ID"/>
		<result property="qnaQnaBoardId" column="QNA_QNA_BOARD_ID" />
		<result property="memberMemberCommentId" column="MEMBER_MEMBER_COMMENT_ID" />
		<result property="qnaBoardCommentTitle" column="QNA_BOARD_COMMENT_TITLE" />
		<result property="qnaBoardCommentContent" column="QNA_BOARD_COMMENT_CONTENT" />
	 	<result property="qnaBoardCommentDay" column="QNA_BOARD_COMMENT_DAY" /> 
	 	<result property="qnaCommentWriter" column="QNA_COMMENT_WRITER" />
	</resultMap>
	
	<sql id ="search">
	
		<if test="condition == 'title'">
			WHERE QNA_BOARD_TITLE LIKE CONCAT('%', #{keyword}, '%')
		</if>
		<if test="condition == 'content'">
			WHERE QNA_BOARD_CONTENT LIKE CONCAT('%', #{keyword}, '%')
		</if>
		<if test="startRegDate != null and startRegDate != ''">
			AND QNA_BOARD_REG_DATE BETWEEN DATE(#{startRegDate}) AND DATE(#{endRegDate})+1 
		</if>
		<if test="keyword != null">
			ORDER BY QNA_BOARD_ID DESC
		</if>
		
	</sql>
	
	
	
	<select id="qnaBoardList" resultMap="QnaBoardMap">
		SELECT * FROM QNA_BOARD ORDER BY QNA_BOARD_ID DESC
	</select>
	
	<select id="qnaBoardDetail" resultMap="QnaBoardMap">
		SELECT A.QNA_BOARD_ID, A.MEMBER_MEMBER_ID, A.QNA_BOARD_TYPE, A.QNA_BOARD_TITLE,
		A.QNA_BOARD_CONTENT, A.QNA_BOARD_REG_DATE, A.QNA_BOARD_VIEW_COUNT, A.QNA_BOARD_PASSWORD, 
		A.QNA_BOARD_IMAGE_NAME, A.QNA_BOARD_SECRET,
		B.QNA_BOARD_COMMENT_ID, B.QNA_QNA_BOARD_ID, B.MEMBER_MEMBER_COMMENT_ID, B.QNA_BOARD_COMMENT_TITLE, B.QNA_BOARD_COMMENT_CONTENT, B.QNA_BOARD_COMMENT_DAY, QNA_COMMENT_WRITER 
		FROM QNA_BOARD A
		LEFT OUTER JOIN QNA_BOARD_COMMENT B
		ON(A.QNA_BOARD_ID = B.QNA_QNA_BOARD_ID)
		WHERE QNA_BOARD_ID = #{qnaBoardId}	
	</select>
	
	
	<select id="searchQna" resultMap="QnaBoardMap">
		SELECT * FROM QNA_BOARD
		<include refid="search"/>
	</select>
	
	<delete id="deleteQnaComment">
		
	</delete>
			
	<delete id="deleteQna">
	
	</delete>
	
</mapper>